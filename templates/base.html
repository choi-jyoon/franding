<!DOCTYPE html>
{% load static %}

<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Franding</title>
    <link rel="shortcut icon" href="{% static 'img/favicon.ico' %}" type="image/x-icon">
    <link rel="icon" href="{% static 'img/favicon.ico' %}" type="image/x-icon">

    <link href="https://unpkg.com/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/bootstrap-icons@1.8.1/font/bootstrap-icons.css">

    <style>
        html,
        body {
            height: 100%;
        }

        body {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .content {
            flex: 1 0 auto;
            /* ì½˜í…ì¸ ê°€ ì°¨ì§€í•  ìˆ˜ ìˆëŠ” ìµœëŒ€ ê³µê°„ì„ ì°¨ì§€í•˜ë„ë¡ ì„¤ì • */
            margin-top: 70px;
            /* ë„¤ë¹„ë°” ë†’ì´ë§Œí¼ ì»¨í…ì¸  ìœ„ì— ë§ˆì§„ ì¶”ê°€ */
            margin-bottom: 150px;
            /* í‘¸í„° ë†’ì´ë§Œí¼ ì»¨í…ì¸  ì•„ë˜ì— ë§ˆì§„ ì¶”ê°€ */

        }

        .footer {
            background-color: #f8f9fa;
            /* ë°ì€ íšŒìƒ‰ */
            flex-shrink: 0;
            /* í‘¸í„°ê°€ ì¶•ì†Œë˜ì§€ ì•Šë„ë¡ ì„¤ì • */
            height: 150px;
            margin-top: auto;
            margin-bottom: 0px;
            padding: 30px;
        }

        .navbar {
            background-color: #5B574F !important;
            height: 70px;
            /* ë„¤ë¹„ë°” ë†’ì´ ì„¤ì • */
            margin-bottom: 70px;
        }

        .navbar-part,
        .nav-part {
            display: flex;
            flex: 1;
            /* ë„¤ë¹„ê²Œì´ì…˜ì˜ ì„¸ ë¶€ë¶„ì´ ë™ì¼í•œ ê³µê°„ì„ ì°¨ì§€í•˜ë„ë¡ í•¨ */
            justify-content: center;
            /* í•­ëª©ë“¤ì„ ê°€ë¡œì¶• ì¤‘ì•™ì— ë°°ì¹˜ */
        }

        .navbar-part:first-child,
        .navbar-part:last-child {
            justify-content: flex-start;
            /* ì²« ë²ˆì§¸ì™€ ë§ˆì§€ë§‰ ë„¤ë¹„ê²Œì´ì…˜ íŒŒíŠ¸ëŠ” ì‹œì‘ì ì— ë§ì¶° ì •ë ¬ */
        }

        .navbar-part:last-child {
            justify-content: flex-end;
            /* ë§ˆì§€ë§‰ ë„¤ë¹„ê²Œì´ì…˜ íŒŒíŠ¸ëŠ” ëì ì— ë§ì¶° ì •ë ¬ */
        }

        .navbar-nav {
            flex-direction: row;
            /* ë„¤ë¹„ê²Œì´ì…˜ í•­ëª©ë“¤ì„ ê°€ë¡œë¡œ ë°°ì—´ */
            padding: 0;
            /* ê¸°ë³¸ íŒ¨ë”© ì œê±° */
        }

        /* nav-itemì— ì ìš©ë˜ëŠ” ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
        .nav-item .nav-link {
            color: white;
            /* ê¸°ë³¸ í…ìŠ¤íŠ¸ ìƒ‰ìƒ */
            transition: color 0.3s;
            /* ìƒ‰ìƒ ë³€ê²½ ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ */
        }

        /* ë§ˆìš°ìŠ¤ hover ì‹œ ì ìš©ë˜ëŠ” ìŠ¤íƒ€ì¼ */
        .nav-item .nav-link:hover {
            color: black;
            /* hover ì‹œ í…ìŠ¤íŠ¸ ìƒ‰ìƒ ë³€ê²½ */
        }

        /* ë“œë¡­ë‹¤ìš´ ë©”ë‰´ê°€ ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê²¨ì ¸ ìˆë„ë¡ ì„¤ì • */
        .navbar-nav .dropdown-menu {
            display: none;
        }

        /* ë“œë¡­ë‹¤ìš´ ë©”ë‰´ ì•„ì´í…œ ì˜†ì˜ ì‚¼ê°í˜• ì•„ì´ì½˜ ì œê±° */
        .nav-link.dropdown-toggle::after {
            display: none;
        }

        /* í˜¸ë²„ ì‹œ ë“œë¡­ë‹¤ìš´ ë©”ë‰´ê°€ í‘œì‹œë˜ë„ë¡ ì„¤ì • */
        .navbar-nav .nav-item:hover .dropdown-menu {
            display: flex;
            /* ë¸”ë¡ ëŒ€ì‹  flexë¥¼ ì‚¬ìš©í•˜ì—¬ ë‚´ìš©ë¬¼ì„ ê°€ë¡œë¡œ ë°°ì—´ */
            flex-direction: row;
            /* í•­ëª©ë“¤ì„ ê°€ë¡œ ë°©í–¥ìœ¼ë¡œ ì •ë ¬ */
        }

        /* horizontal-dropdown í´ë˜ìŠ¤ê°€ ì ìš©ëœ ë“œë¡­ë‹¤ìš´ ë©”ë‰´ì˜ í•­ëª© ìŠ¤íƒ€ì¼ */
        .horizontal-dropdown .dropdown-menu .dropdown-item {
            flex: 0 1 auto;
            /* flex-growëŠ” 0, flex-shrinkëŠ” 1, flex-basisëŠ” autoë¡œ ì„¤ì •í•˜ì—¬ í•­ëª©ë“¤ì´ í•„ìš”í•œ ë§Œí¼ì˜ ê³µê°„ì„ ì°¨ì§€í•˜ë„ë¡ í•¨ */
            white-space: nowrap;
            /* í•­ëª© í…ìŠ¤íŠ¸ê°€ ì¤„ë°”ê¿ˆë˜ì§€ ì•Šë„ë¡ ì„¤ì • */
            padding: 0.5rem 1rem;
            /* ìƒí•˜ 0.5rem, ì¢Œìš° 1remì˜ íŒ¨ë”©ì„ ì¶”ê°€í•˜ì—¬ í•­ëª© ê°„ê²© ì¡°ì • */
        }

        /* í˜¸ë²„ ì‹œ ë“œë¡­ë‹¤ìš´ í•­ëª©ì˜ ë°°ê²½ìƒ‰ ë³€ê²½ ë“±ì˜ ì¶”ê°€ ìŠ¤íƒ€ì¼ */
        .horizontal-dropdown .dropdown-menu .dropdown-item:hover {
            background-color: #f8f9fa;
            /* í˜¸ë²„ ì‹œ í•­ëª©ì˜ ë°°ê²½ìƒ‰ì„ ë³€ê²½ */
            color: #000;
            /* í˜¸ë²„ ì‹œ í•­ëª©ì˜ í…ìŠ¤íŠ¸ ìƒ‰ìƒì„ ê²€ì€ìƒ‰ìœ¼ë¡œ ë³€ê²½ */
        }

        .nav-profile-img {
            width: 40px;
            /* ì•„ì´ì½˜ê³¼ ë™ì¼í•œ í¬ê¸°ë¡œ ì„¤ì • */
            height: 40px;
            /* ì•„ì´ì½˜ê³¼ ë™ì¼í•œ í¬ê¸°ë¡œ ì„¤ì • */
            border-radius: 50%;
            /* ì›í˜• ëª¨ì–‘ ë§Œë“¤ê¸° */
            object-fit: cover;
            /* ì´ë¯¸ì§€ ë¹„ìœ¨ì„ ìœ ì§€í•˜ë©´ì„œ ìš”ì†Œì— ë§ì¶¤ */
        }

        a {
            text-align: center;
            text-decoration: none;
            color: black;
        }
        .open-chatbot-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #5B574F;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        #chatbotContainer {
            display: none;
            position: fixed;
            bottom: 80px;
            right: 20px;
            width: 400px;
            max-height: 600px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            overflow: hidden;
            z-index: 1000;
        }
        .chatbot-widget {
            width: 100%;
            max-height: 100%;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            overflow: hidden;
        }

        .chatbot-header {
            background-color: #5B574F;
            color: white;
            padding: 10px;
            text-align: center;
            cursor: pointer;
        }

        .chatbot-body {
            background-color: white;
            padding: 10px;
            overflow-y: auto;
            height: 330px;
        }

        .chatbot-input {
            display: flex;
        }

        .chatbot-input input {
            flex-grow: 1;
            border: 1px solid #ccc;
            border-radius: 0;
        }

        .chatbot-input button {
            border-radius: 0;
        }

        .chat-message {
            display: flex;
            margin-bottom: 10px;
            align-items: flex-start;
        }

        .chat-message.user .message {
            background-color: #5B574F;
            color: white;
            margin-left: auto;
            border-radius: 15px 15px 0 15px;
        }

        .chat-message.bot .message {
            background-color: #f1f1f1;
            margin-right: auto;
            border-radius: 15px 15px 15px 0;
        }

        .message {
            max-width: 70%;
            padding: 10px;
            word-wrap: break-word;
        }

        .static-profile-image {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 10px;
        }

        .btn-custom {
            background-color: #5B574F;
            color: white;
        }

        .faq-buttons {
            background-color: white; /* ì˜¬ë°”ë¥¸ ì†ì„± ì´ë¦„ */
            display: flex;
            justify-content: space-between;
        }
        .faq-buttons button {
            flex: 1;
            margin: 0 5px;
        }

        /* Three dots animation */
        .typing-indicator {
            display: flex;
            align-items: center;
        }

        .typing-indicator span {
            width: 8px;
            height: 8px;
            margin: 0 2px;
            background-color: #bbb;
            border-radius: 50%;
            display: inline-block;
            animation: typing 1s infinite ease-in-out;
        }

        .typing-indicator span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-indicator span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 80%, 100% {
                transform: scale(0);
            } 40% {
                transform: scale(1);
            }
        }
    </style>
    {% block extra-style %}

    {% endblock %}
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid justify-content-center">
            <!-- ì¢Œì¸¡ í•­ëª©ë“¤ -->
            <div class="navbar-part">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0 justify-content-center">
                    <li class="nav-item horizontal-dropdown" style="margin-right: 20px;">
                        <a class="nav-link dropdown-toggle" href="{% url 'item:perfume_list' %}">Perfume</a>
                        <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <li><a class="dropdown-item" href="{% url 'item:perfume_list' %}?cat1=1">Citrus</a></li>
                            <li><a class="dropdown-item" href="{% url 'item:perfume_list' %}?cat1=2">Floral</a></li>
                            <li><a class="dropdown-item" href="{% url 'item:perfume_list' %}?cat1=3">Sweet</a></li>
                            <li><a class="dropdown-item" href="{% url 'item:perfume_list' %}?cat1=4">Woody</a></li>
                            <li><a class="dropdown-item" href="{% url 'item:perfume_list' %}?cat1=5">Musk</a></li>
                        </ul>
                    </li>
                    <li class="nav-item" style="margin-right: 20px;">
                        <a class="nav-link" href="{% url 'item:other_list' %}">Others</a>
                        <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <li><a class="dropdown-item" href="{% url 'item:other_list' %}?item_type=2">Diffuser</a>
                            </li>
                            <li><a class="dropdown-item" href="{% url 'item:other_list' %}?item_type=3">Fabric Perfume</a></li>
                            <li><a class="dropdown-item" href="{% url 'item:other_list' %}?item_type=4">Candle</a></li>
                            <li><a class="dropdown-item" href="{% url 'item:other_list' %}?item_type=5">ì‹œí–¥ì§€</a></li>

                        </ul>
                    </li>
                    <li class="nav-item" style="margin-right: 20px;">
                        <a class="nav-link" href="{% url 'item:brand_list' %}">Brand</a>
                        <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <li><a class="dropdown-item" href="{% url 'item:brand_list' %}?brand=1">franding</a></li>
                            <li><a class="dropdown-item" href="{% url 'item:brand_list' %}?brand=2">GUCCI</a></li>
                            <li><a class="dropdown-item" href="{% url 'item:brand_list' %}?brand=3">DIPTYQUE</a></li>
                            <li><a class="dropdown-item" href="{% url 'item:brand_list' %}?brand=4">Jo Malone</a></li>
                            <li><a class="dropdown-item" href="{% url 'item:brand_list' %}?brand=5">LE PERSONA</a></li>
                            <li><a class="dropdown-item" href="{% url 'item:brand_list' %}?brand=6">DIOR</a></li>

                        </ul>
                    </li>
                    <li class="nav-item" style="margin-right: 20px;">
                        <a class="nav-link" href="{% url 'event:index' %}">Franding</a>
                    </li>
                    <li class="nav-item" style="margin-right: 20px;">
                        <a class="nav-link" href="{% url 'subscribe:index' %}">Membership</a>
                    </li>
                    <li class="nav-item" style="margin-right: 20px;">
                        <a class="nav-link" href="{% url 'guide:guide_list' %}">Guide</a>                    
                        <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <li><a class="dropdown-item" href="{% url 'guide:pleasant' %}">Pleasant</a></li>
                            <li><a class="dropdown-item" href="{% url 'guide:brand_philosophy' %}">Brand Philosophy</a></li>
                            <li><a class="dropdown-item" href="{% url 'guide:description' %}">Description</a></li>
                            <li><a class="dropdown-item" href="{% url 'guide:scent' %}">Scent</a></li>
                            <li><a class="dropdown-item" href="{% url 'guide:narrative' %}">Narrative</a></li>
                            <li><a class="dropdown-item" href="{% url 'guide:tip' %}">Tip</a></li>
                        </ul>                        
                    </li>
                    <li class="nav-item" style="margin-right: 20px;">
                        <a class="nav-link" href="{% url 'about' %}">About</a>
                    </li>
                </ul>
            </div>
            <!-- ë¡œê³  -->
            <div class="nav-part mx-auto">
                <a class="navbar-brand" href="{% url 'home' %}">
                    <img src="{% static 'img/logo-21.png' %}" alt="Logo" width="65" height="auto" class="d-inline-block align-text-top">
                </a>
            </div>
            <!-- ìš°ì¸¡ í•­ëª©ë“¤ -->
            <div class="navbar-part">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0  align-items-center">
                    <!--ê²€ìƒ‰-->
                    <li class="nav-item me-5">
                        <form action="{% url 'search' %}" method='post'>
                            {% comment %} <form action='' method='post'> {% endcomment %}
                                {% csrf_token %}
                                <div class="input-group mb-0">
                                    <input type="text" class="form-control" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”" aria-label="Search_word" aria-describedby="button-addon2" name="search_word">
                                    <button class="btn btn-secondary" type="submit" id="button-addon2"><i class="bi bi-search"></i></button>
                                </div>
                            </form>
                    </li>
                    <!--ì¥ë°”êµ¬ë‹ˆ-->
                    <li class="nav-item me-3 position-relative">
                        <span class="position-absolute top-0 start-100 translate-middle badge bg-danger rounded-circle" style="font-size: 15px; color: white;" id="badgeCount">
                            {{ cart_count }}
                            <span class="visually-hidden">new ì•ŒëŒ</span>
                        </span>
                        <a class="btn btn-secondary" id="button-addon2" href="{% url 'cart:cart_detail' %}"
                            onclick="checkUserActiveStatus(event)">                            
                            <i class="bi bi-cart4"></i>
                        </a>
                    </li>
                    <!--í”„ë¡œí•„-->
                    <li class="nav-item dropdown">
                        {% if user.is_active %}
                        <a class="nav-link dropdown-toggle text-white" href="#" id="navbarUserDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <!-- í”„ë¡œí•„ ì´ë¯¸ì§€, ì´ë¦„ í‘œì‹œ -->
                            {% if profile_img and profile_img.strip %}
                            <img src="{{profile_img}}" alt="profile_img" class="nav-profile-img"></i>&nbsp;{{user.last_name }}{{ user.first_name }}
                            {% else %}
                            <i class="fas fa-user-circle"></i>&nbsp;{{ user.last_name }}{{ user.first_name }}
                            {% endif %}
                        </a>
                        <ul class="dropdown-menu-start dropdown-menu " aria-labelledby="navbarUserDropdown">
                            <form action="{% url 'logout' %}" method="post">
                                {% csrf_token %}
                                <button type="submit" class="dropdown-item" id="logoutButton">Logout</button>
                            </form>
                            <li><a class="dropdown-item" href="{% url 'mypage:order_index' %}">My Page</a></li>
                        </ul>
                        {% else %}
                        <a class="nav-link dropdown-toggle text-white" href="#" id="navbarAnonymousDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="fas fa-user-circle"></i>&nbsp;Guest
                        </a>
                        <ul class="dropdown-menu dropdown-menu-start" aria-labelledby="navbarAnonymousDropdown">
                            <li><a class="dropdown-item" href="{% url 'login' %}">Login</a></li>
                            <li><a class="dropdown-item" href="{% url 'register' %}">Register</a></li>
                        </ul>
                        {% endif %}
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mb-5">
        {% block content %}{% endblock %}
    </div>
    <button class="open-chatbot-button" id="openChatbotButton">ğŸ’¬</button>
    <div id="chatbotContainer">
        <div class="chatbot-widget" id="chatbotWidget">
            <div class="chatbot-header" id="chatbotHeader">Franding Chatbot</div>
            <div class="chatbot-body" id="chatbotBody">
                <div id="chatbox">
                    <!-- Chat messages will appear here -->
                </div>
            </div>
            <div class="faq-buttons">
                <button type="button" class="btn btn-outline-secondary faq-button">ìˆ² ëƒ„ìƒˆë¥¼ ì¢‹ì•„í•˜ëŠ” ì‚¬ëŒì—ê²Œ ì¶”ì²œí•´ì¤„ ì œí’ˆì€ ë­ê°€ ì¢‹ì„ê¹Œ?</button>
                <button type="button" class="btn btn-outline-secondary faq-button">ê°€ì¥ ë¦¬ë·°ê°€ ì¢‹ì€ ì œí’ˆì€ ë­ì•¼?</button>
                <button type="button" class="btn btn-outline-secondary faq-button">ì‹œíŠ¸ëŸ¬ìŠ¤ëŠ” ë¬´ìŠ¨ í–¥ê¸°ì•¼?</button>
            </div>
            <div class="chatbot-input">
                <input type="text" id="userInput" class="form-control" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”...">
                <button type="button" class="btn btn-custom" id="sendButton">Send</button>
            </div>
        </div>
    </div>

    <input type="hidden" name="csrfmiddlewaretoken" id="csrfToken" value="{{ csrf_token }}">

    {% block footer %}
    <footer class="footer bg-light">
        <div class="container text-center">
            <p>Â© 2024 Franding. All rights reserved.</p>
            <p>Follow us: <a href="#">Facebook</a> | <a href="#">Twitter</a> | <a href="https://www.instagram.com/frand_ing/">Instagram</a></p>
            <p>ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨ | ì´ìš©ì•½ê´€</p>
        </div>
    </footer>
    {% endblock %}

    <script src="https://kit.fontawesome.com/c998a172fe.js" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    {% block extra-script %}{% endblock %}
    <script>

        // ì‚¬ìš©ìì˜ í™œì„± ìƒíƒœë¥¼ Django í…œí”Œë¦¿ì—ì„œ JavaScript ë³€ìˆ˜ë¡œ ì „ë‹¬
        var isUserActive = {{ user.is_active|yesno:"true,false" }};

        function checkUserActiveStatus(event) {
            // ì‚¬ìš©ìê°€ í™œì„± ìƒíƒœì¸ ê²½ìš°
            if (isUserActive) {
                // ì‹¤ì œ ë§í¬ë¡œ ì´ë™
                window.location.href = "{% url 'cart:cart_detail' %}";
            } else {
                // ê¸°ë³¸ ì´ë²¤íŠ¸ë¥¼ ë°©ì§€í•˜ì—¬ ë§í¬ ì´ë™ì„ ë§‰ìŒ
                event.preventDefault();
                // íŒì—… ë©”ì‹œì§€ í‘œì‹œ
                alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");
            }
        }        
        
        document.addEventListener('DOMContentLoaded', function() {            
            const badgeCount = getCartItems();
            if (badgeCount !== null) {
                updateCartBadge(badgeCount);
            } else {
                console.warn('badgeCountê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
            }
        });
        
        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ì¥ë°”êµ¬ë‹ˆ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ê¸°
        function getCartItems() {
            const storedBadgeCount = localStorage.getItem('cart_count');
            return storedBadgeCount
        }

        // ì¥ë°”êµ¬ë‹ˆ ë°°ì§€ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateCartBadge(badge_count) {
            const badge = document.getElementById('badgeCount');
            badge.innerText = badge_count;
            console.log('badge_count',badge_count);
        }

        // ë¡œê·¸ì•„ì›ƒ ì‹œ ì¥ë°”êµ¬ë‹ˆ ë°°ì§€ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì‚­ì œ
        document.addEventListener('DOMContentLoaded', function() {
            var logoutButton = document.getElementById('logoutButton');

            if (logoutButton) {
                logoutButton.addEventListener('click', function() {
                    // ì—¬ê¸°ì„œ 'yourKey'ëŠ” ì‚­ì œí•˜ê³ ì í•˜ëŠ” ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì˜ í‚¤ì…ë‹ˆë‹¤.
                    localStorage.removeItem('cart_count');
                    // í•„ìš”í•œ ê²½ìš° ì—¬ëŸ¬ í‚¤ë¥¼ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                    // localStorage.removeItem('anotherKey');
                });                
            }
        });       

    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
        $(document).ready(function() {
            $('#openChatbotButton').click(function() {
                $('#chatbotContainer').toggle();
            });
            $('#chatbox').append('<div class="chat-message bot"><img src="{% static "img/logo.jpg" %}" alt="Bot" class="static-profile-image"><div class="message"> ì•ˆë…•í•˜ì„¸ìš”! Franding ì±—ë´‡ì…ë‹ˆë‹¤. ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?</div></div>');

            function getCookie(name) {
                let cookieValue = null;
                if (document.cookie && document.cookie !== '') {
                    const cookies = document.cookie.split(';');
                    for (let i = 0; i < cookies.length; i++) {
                        const cookie = cookies[i].trim();
                        if (cookie.substring(0, name.length + 1) === (name + '=')) {
                            cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                            break;
                        }
                    }
                }
                return cookieValue;
            }
            const csrftoken = getCookie('csrftoken');

            $.ajaxSetup({
                beforeSend: function(xhr, settings) {
                    if (!/^(GET|HEAD|OPTIONS|TRACE)$/.test(settings.type) && !this.crossDomain) {
                        xhr.setRequestHeader("X-CSRFToken", csrftoken);
                    }
                }
            });

            function addTypingIndicator() {
                const typingMessageId = 'typing-' + Date.now();
                const typingHtml = `
                    <div class="chat-message bot typing-indicator" id="${typingMessageId}">
                        <img src="{% static 'img/logo.jpg' %}" alt="Bot" class="static-profile-image">
                        <div class="message">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                    </div>
                `;
                $('#chatbox').append(typingHtml);
                return typingMessageId;
            }

            function sendMessage(userMessage) {
                $('#chatbox').append('<div class="chat-message user"><div class="message"> ' + userMessage + '</div></div>');
                
                const typingMessageId = addTypingIndicator();

                $.ajax({
                    type: "POST",
                    url: "{% url 'chatbot:chat_response' %}",
                    data: {
                        message: userMessage,
                        csrfmiddlewaretoken: csrftoken
                    },
                    success: function(data) {
                        const botResponse = data.response;
                        $('#' + typingMessageId).remove(); // ë¡œë”© í”Œë ˆì´ìŠ¤í™€ë” ì§€ìš°ê¸°
                        $('#chatbox').append('<div class="chat-message bot"><img src="{% static "img/logo.jpg" %}" alt="Bot" class="static-profile-image"><div class="message"> ' + botResponse + '</div></div>');
                    },
                    error: function() {
                        $('#' + typingMessageId).remove();
                        $('#chatbox').append('<div class="chat-message bot"><img src="{% static "img/logo.jpg" %}" alt="Bot" class="static-profile-image"><div class="message"> ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</div></div>');
                    }
                });

                $('#userInput').val('');
            }

            $('#userInput').keypress(function(e) {
                if (e.which == 13 && $(this).val().trim() !== '') { // Enter í‚¤ ì…ë ¥ && ì…ë ¥ê°’ì´ ìˆëŠ” ê²½ìš°
                    const userMessage = $(this).val().trim();
                    sendMessage(userMessage);
                    $(this).val(''); // ì…ë ¥ì°½ ì´ˆê¸°í™”
                }
            });

            $('#sendButton').click(function() {
                const userMessage = $('#userInput').val();
                if (userMessage) {
                    sendMessage(userMessage);
                    $('#userInput').val(''); 
                }
            });

            $('.faq-button').click(function() {
                const userMessage = $(this).text();
                sendMessage(userMessage);
            });
        });
    </script>
</body>

</html>